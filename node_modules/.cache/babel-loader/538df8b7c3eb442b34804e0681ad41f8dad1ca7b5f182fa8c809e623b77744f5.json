{"ast":null,"code":"import React,{useState}from'react';import{useAuth}from'../contexts/AuthContext';import{useSale}from'../contexts/SaleContext';import{useNotification}from'../contexts/NotificationContext';import LoadingSpinner from'../components/LoadingSpinner';import{useBarcodeScanner}from'../components/BarcodeScanner';import{useReceiptPrinter}from'../components/ReceiptPrinter';import{PlusIcon,MinusIcon,TrashIcon,UserIcon,CreditCardIcon,PrinterIcon,QrCodeIcon,CheckIcon,BanknotesIcon,DevicePhoneMobileIcon}from'@heroicons/react/24/outline';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function SaleItemCard(_ref){let{item,onUpdateQuantity,onUpdateDiscount,onRemove}=_ref;const[discountInput,setDiscountInput]=useState((item.discount||0).toString());const handleDiscountChange=value=>{setDiscountInput(value);const discount=parseFloat(value)||0;if(discount>=0&&discount<=100){onUpdateDiscount(item.product.id,discount);}};const itemTotal=item.product.price*item.quantity*(1-(item.discount||0)/100);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-4 border\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-gray-900\",children:item.product.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[item.product.brand,\" \",item.product.model]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500\",children:[\"SKU: \",item.product.sku]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onRemove(item.product.id),className:\"p-1 text-red-600 hover:bg-red-50 rounded transition-colors\",children:/*#__PURE__*/_jsx(TrashIcon,{className:\"h-4 w-4\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Unit Price:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium\",children:[\"\\u20B9\",item.product.price.toLocaleString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Quantity:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>onUpdateQuantity(item.product.id,Math.max(1,item.quantity-1)),className:\"p-1 text-gray-600 hover:bg-gray-100 rounded transition-colors\",children:/*#__PURE__*/_jsx(MinusIcon,{className:\"h-4 w-4\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"w-8 text-center font-medium\",children:item.quantity}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onUpdateQuantity(item.product.id,item.quantity+1),className:\"p-1 text-gray-600 hover:bg-gray-100 rounded transition-colors\",children:/*#__PURE__*/_jsx(PlusIcon,{className:\"h-4 w-4\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Discount (%):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",max:\"100\",step:\"0.1\",value:discountInput,onChange:e=>handleDiscountChange(e.target.value),className:\"w-16 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between pt-2 border-t\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-lg text-blue-600\",children:[\"\\u20B9\",itemTotal.toLocaleString()]})]})]})]});}function CustomerSelector(_ref2){let{selectedCustomer,onSelectCustomer}=_ref2;const[isOpen,setIsOpen]=useState(false);const[searchTerm,setSearchTerm]=useState('');const[customers]=useState(mockCustomers);const filteredCustomers=customers.filter(customer=>customer.name.toLowerCase().includes(searchTerm.toLowerCase())||customer.phone.includes(searchTerm)||customer.email&&customer.email.toLowerCase().includes(searchTerm.toLowerCase()));return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setIsOpen(!isOpen),className:\"w-full flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\",children:[/*#__PURE__*/_jsx(UserIcon,{className:\"h-5 w-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"span\",{className:\"flex-1 text-left\",children:selectedCustomer?selectedCustomer.name:'Select Customer (Optional)'})]}),isOpen&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-10 max-h-64 overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 border-b\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search customers...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"w-full px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent\",autoFocus:true})}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-h-48 overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{onSelectCustomer(null);setIsOpen(false);},className:\"w-full px-3 py-2 text-left hover:bg-gray-50 transition-colors\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:\"Walk-in Customer\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"No customer details\"})]}),filteredCustomers.map(customer=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{onSelectCustomer(customer);setIsOpen(false);},className:\"w-full px-3 py-2 text-left hover:bg-gray-50 transition-colors border-t\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:customer.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[customer.phone,\" \\u2022 \",customer.email]})]},customer.id))]})]})]});}export default function SalesPage(){var _currentSale$items;const{user}=useAuth();const{currentSale,addItemToSale,removeItemFromSale,updateItemQuantity,updateItemDiscount,completeSale,cancelSale,calculateTotal,scanBarcode}=useSale();const{addNotification}=useNotification();const{openScanner,ScannerComponent}=useBarcodeScanner();const{showReceipt,ReceiptModal}=useReceiptPrinter();const[selectedCustomer,setSelectedCustomer]=useState(null);const[paymentMethod,setPaymentMethod]=useState('cash');const[isProcessing,setIsProcessing]=useState(false);const[showPayment,setShowPayment]=useState(false);const total=calculateTotal();const hasItems=((currentSale===null||currentSale===void 0?void 0:(_currentSale$items=currentSale.items)===null||_currentSale$items===void 0?void 0:_currentSale$items.length)||0)>0;const handleScanBarcode=async barcode=>{try{const product=await scanBarcode(barcode);if(product){addItemToSale(product,1);addNotification({type:'success',title:'Product Added',message:`${product.name} added to sale`});}else{addNotification({type:'error',title:'Product Not Found',message:'No product found with this barcode'});}}catch(error){addNotification({type:'error',title:'Scan Failed',message:'Failed to scan barcode'});}};const handleCompleteSale=async()=>{if(!hasItems)return;setIsProcessing(true);try{await completeSale(paymentMethod);addNotification({type:'success',title:'Sale Completed',message:`Sale completed successfully. Total: â‚¹${total.toLocaleString()}`});// Reset form\nsetSelectedCustomer(null);setPaymentMethod('cash');setShowPayment(false);// Show receipt for printing\nif(currentSale){showReceipt({sale:{...currentSale,status:'completed',paymentMethod,completedAt:new Date()},customer:selectedCustomer,paymentMethod,cashier:(user===null||user===void 0?void 0:user.name)||'Cashier',shopInfo:{name:'Electronics Shop POS',address:'123 Tech Street, Electronics Market, City - 123456',phone:'+91 9876543210',email:'info@electronicsshop.com',gst:'GST123456789'}});}addNotification({type:'success',title:'Sale Completed',message:'Sale completed successfully. Receipt is ready for printing.'});}catch(error){addNotification({type:'error',title:'Sale Failed',message:'Failed to complete sale. Please try again.'});}finally{setIsProcessing(false);}};const handleCancelSale=()=>{if(hasItems){const confirmed=window.confirm('Are you sure you want to cancel this sale? All items will be removed.');if(confirmed){cancelSale();setSelectedCustomer(null);setPaymentMethod('cash');setShowPayment(false);addNotification({type:'info',title:'Sale Cancelled',message:'Sale has been cancelled'});}}};const paymentIcons={cash:BanknotesIcon,card:CreditCardIcon,upi:DevicePhoneMobileIcon,bank_transfer:CreditCardIcon};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"New Sale\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Scan products or add them manually\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-2\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>openScanner(handleScanBarcode),className:\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\",children:[/*#__PURE__*/_jsx(QrCodeIcon,{className:\"h-5 w-5\"}),\"Scan Barcode\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lg:col-span-2 space-y-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Sale Items\"}),hasItems?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:currentSale===null||currentSale===void 0?void 0:currentSale.items.map(item=>/*#__PURE__*/_jsx(SaleItemCard,{item:item,onUpdateQuantity:updateItemQuantity,onUpdateDiscount:updateItemDiscount,onRemove:removeItemFromSale},item.product.id))}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(QrCodeIcon,{className:\"h-12 w-12 text-gray-400 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-500 text-lg\",children:\"No items in sale\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 text-sm mt-2\",children:\"Scan a barcode or browse products to add items\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-3\",children:\"Customer\"}),/*#__PURE__*/_jsx(CustomerSelector,{selectedCustomer:selectedCustomer,onSelectCustomer:setSelectedCustomer})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-3\",children:\"Sale Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Items:\"}),/*#__PURE__*/_jsx(\"span\",{children:(currentSale===null||currentSale===void 0?void 0:currentSale.items.reduce((sum,item)=>sum+item.quantity,0))||0})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Subtotal:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",((currentSale===null||currentSale===void 0?void 0:currentSale.items.reduce((sum,item)=>sum+item.product.price*item.quantity,0))||0).toLocaleString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Discount:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"-\\u20B9\",(((currentSale===null||currentSale===void 0?void 0:currentSale.items.reduce((sum,item)=>sum+item.product.price*item.quantity,0))||0)-total).toLocaleString()]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t pt-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-lg font-bold\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-600\",children:[\"\\u20B9\",total.toLocaleString()]})]})})]}),hasItems&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[!showPayment?/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowPayment(true),className:\"w-full px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium\",children:\"Proceed to Payment\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Payment Method\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-2\",children:['cash','card','upi','bank_transfer'].map(method=>{const Icon=paymentIcons[method];return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setPaymentMethod(method),className:`flex items-center gap-2 px-3 py-2 rounded-lg border transition-colors ${paymentMethod===method?'border-blue-500 bg-blue-50 text-blue-700':'border-gray-300 hover:bg-gray-50'}`,children:[/*#__PURE__*/_jsx(Icon,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm capitalize\",children:method==='bank_transfer'?'Bank':method})]},method);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowPayment(false),className:\"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors\",children:\"Back\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCompleteSale,disabled:isProcessing,className:\"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors\",children:isProcessing?/*#__PURE__*/_jsx(LoadingSpinner,{size:\"small\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CheckIcon,{className:\"h-4 w-4\"}),\"Complete\"]})})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCancelSale,className:\"w-full px-4 py-2 border border-red-300 text-red-700 rounded-lg hover:bg-red-50 transition-colors\",children:\"Cancel Sale\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-3\",children:\"Quick Actions\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"w-full flex items-center gap-2 px-3 py-2 text-left text-gray-700 hover:bg-gray-50 rounded-lg transition-colors\",children:[/*#__PURE__*/_jsx(PrinterIcon,{className:\"h-4 w-4\"}),\"Print Last Receipt\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"w-full flex items-center gap-2 px-3 py-2 text-left text-gray-700 hover:bg-gray-50 rounded-lg transition-colors\",children:[/*#__PURE__*/_jsx(UserIcon,{className:\"h-4 w-4\"}),\"Add New Customer\"]})]})]})]})]}),/*#__PURE__*/_jsx(ScannerComponent,{}),/*#__PURE__*/_jsx(ReceiptModal,{})]});}// Mock data\nconst mockCustomers=[{id:'1',name:'John Doe',email:'john.doe@email.com',phone:'+91 9876543210',address:'123 Main Street, City, State 12345',createdAt:new Date(),totalPurchases:5,lastVisit:new Date()},{id:'2',name:'Jane Smith',email:'jane.smith@email.com',phone:'+91 9876543211',address:'456 Oak Avenue, City, State 12346',createdAt:new Date(),totalPurchases:3,lastVisit:new Date()},{id:'3',name:'Mike Johnson',email:'mike.johnson@email.com',phone:'+91 9876543212',address:'789 Pine Road, City, State 12347',createdAt:new Date(),totalPurchases:8,lastVisit:new Date()}];","map":{"version":3,"names":["React","useState","useAuth","useSale","useNotification","LoadingSpinner","useBarcodeScanner","useReceiptPrinter","PlusIcon","MinusIcon","TrashIcon","UserIcon","CreditCardIcon","PrinterIcon","QrCodeIcon","CheckIcon","BanknotesIcon","DevicePhoneMobileIcon","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SaleItemCard","_ref","item","onUpdateQuantity","onUpdateDiscount","onRemove","discountInput","setDiscountInput","discount","toString","handleDiscountChange","value","parseFloat","product","id","itemTotal","price","quantity","className","children","name","brand","model","sku","onClick","toLocaleString","Math","max","type","min","step","onChange","e","target","CustomerSelector","_ref2","selectedCustomer","onSelectCustomer","isOpen","setIsOpen","searchTerm","setSearchTerm","customers","mockCustomers","filteredCustomers","filter","customer","toLowerCase","includes","phone","email","placeholder","autoFocus","map","SalesPage","_currentSale$items","user","currentSale","addItemToSale","removeItemFromSale","updateItemQuantity","updateItemDiscount","completeSale","cancelSale","calculateTotal","scanBarcode","addNotification","openScanner","ScannerComponent","showReceipt","ReceiptModal","setSelectedCustomer","paymentMethod","setPaymentMethod","isProcessing","setIsProcessing","showPayment","setShowPayment","total","hasItems","items","length","handleScanBarcode","barcode","title","message","error","handleCompleteSale","sale","status","completedAt","Date","cashier","shopInfo","address","gst","handleCancelSale","confirmed","window","confirm","paymentIcons","cash","card","upi","bank_transfer","reduce","sum","method","Icon","disabled","size","createdAt","totalPurchases","lastVisit"],"sources":["D:/restaurantPOS/src/pages/SalesPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Sale, SaleItem, Customer, Product } from '../types';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useSale } from '../contexts/SaleContext';\nimport { useNotification } from '../contexts/NotificationContext';\nimport LoadingSpinner from '../components/LoadingSpinner';\nimport { useBarcodeScanner } from '../components/BarcodeScanner';\nimport { useReceiptPrinter } from '../components/ReceiptPrinter';\nimport {\n  PlusIcon,\n  MinusIcon,\n  TrashIcon,\n  UserIcon,\n  CreditCardIcon,\n  PrinterIcon,\n  QrCodeIcon,\n  XMarkIcon,\n  CheckIcon,\n  BanknotesIcon,\n  DevicePhoneMobileIcon,\n} from '@heroicons/react/24/outline';\n\ninterface SaleItemCardProps {\n  item: SaleItem;\n  onUpdateQuantity: (productId: string, quantity: number) => void;\n  onUpdateDiscount: (productId: string, discount: number) => void;\n  onRemove: (productId: string) => void;\n}\n\nfunction SaleItemCard({ item, onUpdateQuantity, onUpdateDiscount, onRemove }: SaleItemCardProps) {\n  const [discountInput, setDiscountInput] = useState((item.discount || 0).toString());\n\n  const handleDiscountChange = (value: string) => {\n    setDiscountInput(value);\n    const discount = parseFloat(value) || 0;\n    if (discount >= 0 && discount <= 100) {\n      onUpdateDiscount(item.product.id, discount);\n    }\n  };\n\n  const itemTotal = (item.product.price * item.quantity) * (1 - (item.discount || 0) / 100);\n\n  return (\n    <div className=\"bg-white rounded-lg shadow p-4 border\">\n      <div className=\"flex items-start justify-between mb-3\">\n        <div className=\"flex-1\">\n          <h3 className=\"font-semibold text-gray-900\">{item.product.name}</h3>\n          <p className=\"text-sm text-gray-600\">{item.product.brand} {item.product.model}</p>\n          <p className=\"text-xs text-gray-500\">SKU: {item.product.sku}</p>\n        </div>\n        <button\n          onClick={() => onRemove(item.product.id)}\n          className=\"p-1 text-red-600 hover:bg-red-50 rounded transition-colors\"\n        >\n          <TrashIcon className=\"h-4 w-4\" />\n        </button>\n      </div>\n\n      <div className=\"space-y-3\">\n        <div className=\"flex items-center justify-between\">\n          <span className=\"text-sm text-gray-600\">Unit Price:</span>\n          <span className=\"font-medium\">â‚¹{item.product.price.toLocaleString()}</span>\n        </div>\n\n        <div className=\"flex items-center justify-between\">\n          <span className=\"text-sm text-gray-600\">Quantity:</span>\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={() => onUpdateQuantity(item.product.id, Math.max(1, item.quantity - 1))}\n              className=\"p-1 text-gray-600 hover:bg-gray-100 rounded transition-colors\"\n            >\n              <MinusIcon className=\"h-4 w-4\" />\n            </button>\n            <span className=\"w-8 text-center font-medium\">{item.quantity}</span>\n            <button\n              onClick={() => onUpdateQuantity(item.product.id, item.quantity + 1)}\n              className=\"p-1 text-gray-600 hover:bg-gray-100 rounded transition-colors\"\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n\n        <div className=\"flex items-center justify-between\">\n          <span className=\"text-sm text-gray-600\">Discount (%):</span>\n          <input\n            type=\"number\"\n            min=\"0\"\n            max=\"100\"\n            step=\"0.1\"\n            value={discountInput}\n            onChange={(e) => handleDiscountChange(e.target.value)}\n            className=\"w-16 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent text-center\"\n          />\n        </div>\n\n        <div className=\"flex items-center justify-between pt-2 border-t\">\n          <span className=\"font-medium text-gray-900\">Total:</span>\n          <span className=\"font-bold text-lg text-blue-600\">â‚¹{itemTotal.toLocaleString()}</span>\n        </div>\n      </div>\n      \n      {/* Barcode scanner component would go here */}\n    </div>\n  );\n}\n\ninterface CustomerSelectorProps {\n  selectedCustomer: Customer | null;\n  onSelectCustomer: (customer: Customer | null) => void;\n}\n\nfunction CustomerSelector({ selectedCustomer, onSelectCustomer }: CustomerSelectorProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [customers] = useState<Customer[]>(mockCustomers);\n\n  const filteredCustomers = customers.filter(customer =>\n    customer.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    customer.phone.includes(searchTerm) ||\n    (customer.email && customer.email.toLowerCase().includes(searchTerm.toLowerCase()))\n  );\n\n  return (\n    <div className=\"relative\">\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"w-full flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors\"\n      >\n        <UserIcon className=\"h-5 w-5 text-gray-400\" />\n        <span className=\"flex-1 text-left\">\n          {selectedCustomer ? selectedCustomer.name : 'Select Customer (Optional)'}\n        </span>\n      </button>\n\n      {isOpen && (\n        <div className=\"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-10 max-h-64 overflow-hidden\">\n          <div className=\"p-3 border-b\">\n            <input\n              type=\"text\"\n              placeholder=\"Search customers...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              autoFocus\n            />\n          </div>\n          <div className=\"max-h-48 overflow-y-auto\">\n            <button\n              onClick={() => {\n                onSelectCustomer(null);\n                setIsOpen(false);\n              }}\n              className=\"w-full px-3 py-2 text-left hover:bg-gray-50 transition-colors\"\n            >\n              <div className=\"font-medium\">Walk-in Customer</div>\n              <div className=\"text-sm text-gray-500\">No customer details</div>\n            </button>\n            {filteredCustomers.map(customer => (\n              <button\n                key={customer.id}\n                onClick={() => {\n                  onSelectCustomer(customer);\n                  setIsOpen(false);\n                }}\n                className=\"w-full px-3 py-2 text-left hover:bg-gray-50 transition-colors border-t\"\n              >\n                <div className=\"font-medium\">{customer.name}</div>\n                <div className=\"text-sm text-gray-500\">{customer.phone} â€¢ {customer.email}</div>\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default function SalesPage() {\n  const { user } = useAuth();\n  const {\n    currentSale,\n    addItemToSale,\n    removeItemFromSale,\n    updateItemQuantity,\n    updateItemDiscount,\n    completeSale,\n    cancelSale,\n    calculateTotal,\n    scanBarcode,\n  } = useSale();\n  const { addNotification } = useNotification();\n  const { openScanner, ScannerComponent } = useBarcodeScanner();\n  const { showReceipt, ReceiptModal } = useReceiptPrinter();\n  \n  const [selectedCustomer, setSelectedCustomer] = useState<Customer | null>(null);\n  const [paymentMethod, setPaymentMethod] = useState<'cash' | 'card' | 'upi' | 'bank_transfer'>('cash');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [showPayment, setShowPayment] = useState(false);\n\n  const total = calculateTotal();\n  const hasItems = (currentSale?.items?.length || 0) > 0;\n\n  const handleScanBarcode = async (barcode: string) => {\n    try {\n      const product = await scanBarcode(barcode);\n      if (product) {\n        addItemToSale(product, 1);\n        addNotification({\n          type: 'success',\n          title: 'Product Added',\n          message: `${product.name} added to sale`,\n        });\n      } else {\n        addNotification({\n          type: 'error',\n          title: 'Product Not Found',\n          message: 'No product found with this barcode',\n        });\n      }\n    } catch (error) {\n      addNotification({\n        type: 'error',\n        title: 'Scan Failed',\n        message: 'Failed to scan barcode',\n      });\n    }\n  };\n\n  const handleCompleteSale = async () => {\n    if (!hasItems) return;\n\n    setIsProcessing(true);\n    try {\n      await completeSale(paymentMethod);\n      \n      addNotification({\n        type: 'success',\n        title: 'Sale Completed',\n        message: `Sale completed successfully. Total: â‚¹${total.toLocaleString()}`,\n      });\n      \n      // Reset form\n      setSelectedCustomer(null);\n      setPaymentMethod('cash');\n      setShowPayment(false);\n      \n      // Show receipt for printing\n      if (currentSale) {\n        showReceipt({\n          sale: {\n            ...currentSale,\n            status: 'completed',\n            paymentMethod,\n            completedAt: new Date(),\n          },\n          customer: selectedCustomer,\n          paymentMethod,\n          cashier: user?.name || 'Cashier',\n          shopInfo: {\n            name: 'Electronics Shop POS',\n            address: '123 Tech Street, Electronics Market, City - 123456',\n            phone: '+91 9876543210',\n            email: 'info@electronicsshop.com',\n            gst: 'GST123456789',\n          },\n        });\n      }\n      \n      addNotification({\n        type: 'success',\n        title: 'Sale Completed',\n        message: 'Sale completed successfully. Receipt is ready for printing.',\n      });\n      \n    } catch (error) {\n      addNotification({\n        type: 'error',\n        title: 'Sale Failed',\n        message: 'Failed to complete sale. Please try again.',\n      });\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleCancelSale = () => {\n    if (hasItems) {\n      const confirmed = window.confirm('Are you sure you want to cancel this sale? All items will be removed.');\n      if (confirmed) {\n        cancelSale();\n        setSelectedCustomer(null);\n        setPaymentMethod('cash');\n        setShowPayment(false);\n        addNotification({\n          type: 'info',\n          title: 'Sale Cancelled',\n          message: 'Sale has been cancelled',\n        });\n      }\n    }\n  };\n\n  const paymentIcons = {\n    cash: BanknotesIcon,\n    card: CreditCardIcon,\n    upi: DevicePhoneMobileIcon,\n    bank_transfer: CreditCardIcon,\n  };\n\n  return (\n    <div className=\"max-w-4xl mx-auto space-y-6\">\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">New Sale</h1>\n          <p className=\"text-gray-600\">Scan products or add them manually</p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <button\n            onClick={() => openScanner(handleScanBarcode)}\n            className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n          >\n            <QrCodeIcon className=\"h-5 w-5\" />\n            Scan Barcode\n          </button>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Sale Items */}\n        <div className=\"lg:col-span-2 space-y-4\">\n          <div className=\"bg-gray-50 rounded-lg p-4\">\n            <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">Sale Items</h2>\n            \n            {hasItems ? (\n              <div className=\"space-y-4\">\n                {currentSale?.items.map(item => (\n                  <SaleItemCard\n                    key={item.product.id}\n                    item={item}\n                    onUpdateQuantity={updateItemQuantity}\n                    onUpdateDiscount={updateItemDiscount}\n                    onRemove={removeItemFromSale}\n                  />\n                ))}\n              </div>\n            ) : (\n              <div className=\"text-center py-12\">\n                <QrCodeIcon className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                <div className=\"text-gray-500 text-lg\">No items in sale</div>\n                <div className=\"text-gray-400 text-sm mt-2\">\n                  Scan a barcode or browse products to add items\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Sale Summary */}\n        <div className=\"space-y-4\">\n          {/* Customer Selection */}\n          <div className=\"bg-white rounded-lg shadow p-4\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-3\">Customer</h3>\n            <CustomerSelector\n              selectedCustomer={selectedCustomer}\n              onSelectCustomer={setSelectedCustomer}\n            />\n          </div>\n\n          {/* Sale Total */}\n          <div className=\"bg-white rounded-lg shadow p-4\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-3\">Sale Summary</h3>\n            \n            <div className=\"space-y-2 mb-4\">\n              <div className=\"flex justify-between text-sm\">\n                <span>Items:</span>\n                <span>{currentSale?.items.reduce((sum, item) => sum + item.quantity, 0) || 0}</span>\n              </div>\n              <div className=\"flex justify-between text-sm\">\n                <span>Subtotal:</span>\n                <span>â‚¹{(currentSale?.items.reduce((sum, item) => sum + (item.product.price * item.quantity), 0) || 0).toLocaleString()}</span>\n              </div>\n              <div className=\"flex justify-between text-sm\">\n                <span>Discount:</span>\n                <span>-â‚¹{((currentSale?.items.reduce((sum, item) => sum + (item.product.price * item.quantity), 0) || 0) - total).toLocaleString()}</span>\n              </div>\n              <div className=\"border-t pt-2\">\n                <div className=\"flex justify-between text-lg font-bold\">\n                  <span>Total:</span>\n                  <span className=\"text-blue-600\">â‚¹{total.toLocaleString()}</span>\n                </div>\n              </div>\n            </div>\n\n            {hasItems && (\n              <div className=\"space-y-3\">\n                {!showPayment ? (\n                  <button\n                    onClick={() => setShowPayment(true)}\n                    className=\"w-full px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium\"\n                  >\n                    Proceed to Payment\n                  </button>\n                ) : (\n                  <div className=\"space-y-3\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                        Payment Method\n                      </label>\n                      <div className=\"grid grid-cols-2 gap-2\">\n                        {(['cash', 'card', 'upi', 'bank_transfer'] as const).map(method => {\n                          const Icon = paymentIcons[method];\n                          return (\n                            <button\n                              key={method}\n                              onClick={() => setPaymentMethod(method)}\n                              className={`flex items-center gap-2 px-3 py-2 rounded-lg border transition-colors ${\n                                paymentMethod === method\n                                  ? 'border-blue-500 bg-blue-50 text-blue-700'\n                                  : 'border-gray-300 hover:bg-gray-50'\n                              }`}\n                            >\n                              <Icon className=\"h-4 w-4\" />\n                              <span className=\"text-sm capitalize\">\n                                {method === 'bank_transfer' ? 'Bank' : method}\n                              </span>\n                            </button>\n                          );\n                        })}\n                      </div>\n                    </div>\n\n                    <div className=\"flex gap-2\">\n                      <button\n                        onClick={() => setShowPayment(false)}\n                        className=\"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors\"\n                      >\n                        Back\n                      </button>\n                      <button\n                        onClick={handleCompleteSale}\n                        disabled={isProcessing}\n                        className=\"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors\"\n                      >\n                        {isProcessing ? (\n                          <LoadingSpinner size=\"small\" />\n                        ) : (\n                          <>\n                            <CheckIcon className=\"h-4 w-4\" />\n                            Complete\n                          </>\n                        )}\n                      </button>\n                    </div>\n                  </div>\n                )}\n\n                <button\n                  onClick={handleCancelSale}\n                  className=\"w-full px-4 py-2 border border-red-300 text-red-700 rounded-lg hover:bg-red-50 transition-colors\"\n                >\n                  Cancel Sale\n                </button>\n              </div>\n            )}\n          </div>\n\n          {/* Quick Actions */}\n          <div className=\"bg-white rounded-lg shadow p-4\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-3\">Quick Actions</h3>\n            <div className=\"space-y-2\">\n              <button className=\"w-full flex items-center gap-2 px-3 py-2 text-left text-gray-700 hover:bg-gray-50 rounded-lg transition-colors\">\n                <PrinterIcon className=\"h-4 w-4\" />\n                Print Last Receipt\n              </button>\n              <button className=\"w-full flex items-center gap-2 px-3 py-2 text-left text-gray-700 hover:bg-gray-50 rounded-lg transition-colors\">\n                <UserIcon className=\"h-4 w-4\" />\n                Add New Customer\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <ScannerComponent />\n      <ReceiptModal />\n    </div>\n  );\n}\n\n// Mock data\nconst mockCustomers: Customer[] = [\n  {\n    id: '1',\n    name: 'John Doe',\n    email: 'john.doe@email.com',\n    phone: '+91 9876543210',\n    address: '123 Main Street, City, State 12345',\n    createdAt: new Date(),\n    totalPurchases: 5,\n    lastVisit: new Date(),\n  },\n  {\n    id: '2',\n    name: 'Jane Smith',\n    email: 'jane.smith@email.com',\n    phone: '+91 9876543211',\n    address: '456 Oak Avenue, City, State 12346',\n    createdAt: new Date(),\n    totalPurchases: 3,\n    lastVisit: new Date(),\n  },\n  {\n    id: '3',\n    name: 'Mike Johnson',\n    email: 'mike.johnson@email.com',\n    phone: '+91 9876543212',\n    address: '789 Pine Road, City, State 12347',\n    createdAt: new Date(),\n    totalPurchases: 8,\n    lastVisit: new Date(),\n  },\n];"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}